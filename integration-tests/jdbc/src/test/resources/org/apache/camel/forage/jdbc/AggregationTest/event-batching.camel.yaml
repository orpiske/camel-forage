- route:
    id: event-batching
    from:
      id: from-events
      uri: direct
      parameters:
        name: events
      steps:
        - log:
            id: log-received
            message: "Received event with id :${header.eventId} and body: ${body}"
        - aggregate:
            id: aggregate-batch
            steps:
              - log:
                  id: log-complete
                  message: "Batch complete with ${exchangeProperty.CamelAggregatedSize} event id:
                    ${header.eventId} and events: ${body}"
            aggregationRepository: "#event_aggregation"
            aggregationStrategy: "#groupedBodyAggregationStrategy"
            completionSize: 3
            completionTimeout: "30000"
            correlationExpression:
              header:
                expression: eventId
- beans:
    - name: groupedBodyAggregationStrategy
      type: org.apache.camel.test.MyAggregationStrategy
